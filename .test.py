IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgc29ja2V0CmltcG9ydCBpcGFkZHJlc3MKaW1wb3J0IHJlCgpwb3J0X3JhbmdlX3BhdHRlcm4gPSByZS5jb21waWxlKCIoWzAtOV0rKS0oWzAtOV0rKSIpCnBvcnRfbWluID0gMApwb3J0X21heCA9IDY1NTM1CgoKcHJpbnQoIiIiClx04pSP4pSB4pSB4pSB4pST4pSP4pSB4pSB4pSB4pSz4pSB4pST4pWL4pSP4pSz4pSB4pSB4pSz4pSB4pSB4pSB4pSz4pSB4pSB4pSB4pSTClx04pSD4pSP4pSB4pSB4pSb4pSD4pSP4pSB4pST4pSD4pSD4pSX4pST4pSD4pSj4pSr4pSj4pSr4pSP4pSB4pSB4pSr4pSP4pSB4pSB4pSbClx04pSD4pSX4pSB4pSB4pST4pSD4pSX4pSB4pSB4pSr4pSP4pST4pSX4pSb4pSD4pSD4pSD4pSD4pSX4pSB4pSB4pSr4pSX4pSB4pSB4pSTClx04pSD4pSP4pSB4pSB4pSb4pSX4pSB4pSB4pST4pSD4pSD4pSX4pST4pSD4pSD4pSD4pSD4pSD4pSP4pSB4pSB4pSr4pSP4pSB4pSB4pSbClx04pSD4pSX4pSB4pSB4pST4pSD4pSX4pSB4pSb4pSD4pSD4pWL4pSD4pSD4pSj4pSr4pSj4pSr4pSD4pWL4pWL4pSD4pSDClx04pSX4pSB4pSB4pSB4pSb4pSX4pSB4pSB4pSB4pS74pSb4pWL4pSX4pSB4pS74pSB4pSB4pS74pSb4pWL4pWL4pSX4pSbIiIiKQpwcmludCgiXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIikKcHJpbnQoIlxuKiBDb3B5cmlnaHQgb2YgRW50aGVybmV0Q29kZSwgMjAyMyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiIpCnByaW50KCJcbiogaHR0cHM6Ly93d3cuZW50aGVybmV0LmNvbV9fX19fX19fX19fX19fY29tbWluZ19zb29uICAgICAgICAgICoiKQpwcmludCgiXG4qIGh0dHBzOi8vd3d3LmdpdGh1Yi5jb20vRW50aGVybmV0Y29kZSAgICAgICAgICAgICAgICAgICAgICAgICAqIikKcHJpbnQoIlxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiIpCgpvcGVuX3BvcnRzID0gW10KY2xvc2VkX3BvcnRzID0gW10Kd2hpbGUgVHJ1ZToKICAgIGlwX2FkZF9lbnRlcmVkID0gaW5wdXQoIlxuUGxlYXNlIGVudGVyIHRoZSBpcCBhZGRyZXNzIHRoYXQgeW91IHdhbnQgdG8gc2NhbjogIikKICAgIHRyeToKICAgICAgICBpcF9hZGRyZXNzX29iaiA9IGlwYWRkcmVzcy5pcF9hZGRyZXNzKGlwX2FkZF9lbnRlcmVkKQogICAgICAgIHByaW50KCJZb3UgZW50ZXJlZCBhIHZhbGlkIGlwIGFkZHJlc3MuIikKICAgICAgICBicmVhawogICAgZXhjZXB0OgogICAgICAgIHByaW50KCJZb3UgZW50ZXJlZCBhbiBpbnZhbGlkIGlwIGFkZHJlc3MiKQogICAgCgp3aGlsZSBUcnVlOgogICAgcHJpbnQoIlBsZWFzZSBlbnRlciB0aGUgcmFuZ2Ugb2YgcG9ydHMgeW91IHdhbnQgdG8gc2NhbiBpbiBmb3JtYXQ6IDxpbnQ+LTxpbnQ+IChleCB3b3VsZCBiZSA2MC0xMjApIikKICAgIHBvcnRfcmFuZ2UgPSBpbnB1dCgiRW50ZXIgcG9ydCByYW5nZTogIikKICAgIHBvcnRfcmFuZ2VfdmFsaWQgPSBwb3J0X3JhbmdlX3BhdHRlcm4uc2VhcmNoKHBvcnRfcmFuZ2UucmVwbGFjZSgiICIsIiIpKQogICAgaWYgcG9ydF9yYW5nZV92YWxpZDoKICAgICAgICBwb3J0X21pbiA9IGludChwb3J0X3JhbmdlX3ZhbGlkLmdyb3VwKDEpKQogICAgICAgIHBvcnRfbWF4ID0gaW50KHBvcnRfcmFuZ2VfdmFsaWQuZ3JvdXAoMikpCiAgICAgICAgYnJlYWsKCmZvciBwb3J0IGluIHJhbmdlKHBvcnRfbWluLCBwb3J0X21heCArIDEpOgogICAgdHJ5OgogICAgICAgIHdpdGggc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKSBhcyBzOgogICAgICAgICAgICBzLnNldHRpbWVvdXQoMC41KQogICAgICAgICAgICBzLmNvbm5lY3QoKGlwX2FkZF9lbnRlcmVkLCBwb3J0KSkKICAgICAgICAgICAgb3Blbl9wb3J0cy5hcHBlbmQocG9ydCkKCiAgICBleGNlcHQ6CiAgICAgICAgY2xvc2VkX3BvcnRzLmFwcGVuZChwb3J0KQoKZm9yIHBvcnQgaW4gb3Blbl9wb3J0czoKICAgIHByaW50KGYiUG9ydCB7cG9ydH0gaXMgb3BlbiBvbiB7aXBfYWRkX2VudGVyZWR9LiIpCgpwcmludChyIldvdWxkIHlvdSBsaWtlIHRvIHNlZSB0aGUgY2xvc2VkIFBvcnRzIikKb3B0ID0gaW5wdXQoIlllcyBvciBObzogXHQiKS5sb3dlcigpCmlmIG9wdD09InllcyI6CiBmb3IgcG9ydCBpbiBjbG9zZWRfcG9ydHM6CiAgICBwcmludChmIlBvcnQge3BvcnR9IGlzIGNsb3NlZCBvbiB7aXBfYWRkX2VudGVyZWR9LiIpCgo=%
